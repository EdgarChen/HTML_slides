<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add-on</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h2 id="spark-add-on-on-b2g">Spark Add-on on b2g</h2>

<dl>
<dt>Bugs</dt>
<dd><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1162200">Bug 1162200 - (spark-addons) [Meta] Spark Add-ons Support</a> <br>
– <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=923897">Bug 923897 - Extensibility support for b2g</a></dd>
</dl>



<h4 id="reuse-mozapps-and-manifestwebapp">Reuse <a href="https://dxr.mozilla.org/mozilla-central/source/dom/webidl/Apps.webidl"><code>mozApps</code></a> and <code>manifest.webapp</code>:</h4>



<pre class="prettyprint"><code class=" hljs avrasm">navigator<span class="hljs-preprocessor">.mozApps</span><span class="hljs-preprocessor">.installPackage</span>(AddonManifestURL)<span class="hljs-comment">;</span>
navigator<span class="hljs-preprocessor">.mozApps</span><span class="hljs-preprocessor">.mgmt</span><span class="hljs-preprocessor">.uninstall</span>(DOMApplication)<span class="hljs-comment">;</span></code></pre>



<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-comment">// manifest.webapp example</span>
{
  <span class="hljs-string">"customizations"</span>: [
    {
      <span class="hljs-comment">/* mandatory */</span>
      <span class="hljs-string">"filter"</span>: <span class="hljs-string">"http://youtube.com"</span>,
      <span class="hljs-string">"css"</span>: [<span class="hljs-string">"file1.css"</span>, <span class="hljs-string">"file2.css"</span>],
      <span class="hljs-string">"scripts"</span>: [<span class="hljs-string">"script1.js"</span>, <span class="hljs-string">"script2.js"</span>]
    }
  ], 
  <span class="hljs-string">"role"</span>: <span class="hljs-string">"addon"</span> <span class="hljs-comment">// "theme"</span>
}</code></pre>

<p>Only allow customizations to apply to apps with an equal or lower privilege level.</p>



<h4 id="installation">Installation</h4>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.5px; top: 0.0333252px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1144.5" version="1.1" height="650"><desc>Created with Raphaël 2.1.2</desc><defs><path id="raphael-marker-block" d="M5,0 0,2.5 5,5z" stroke-linecap="round"></path><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj88"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj91"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj94"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj106"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj109"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj112"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj117"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj120"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj125"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="44" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="24" y="30" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="32" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">App</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="44" y="590" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="24" y="600" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="32" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">App</tspan></text><path stroke-width="2" d="M32,60L32,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="91" y="20" x="331.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="71" y="30" x="341.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="377" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="91" y="590" x="331.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="71" y="600" x="341.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="377" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.js</tspan></text><path stroke-width="2" d="M377,60L377,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="20" x="518.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="30" x="528.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="570" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="590" x="518.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="600" x="528.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="570" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><path stroke-width="2" d="M570,60L570,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="20" x="768.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="30" x="778.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="854" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="590" x="768.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="600" x="778.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="854" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><path stroke-width="2" d="M854,60L854,590" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="325" y="75" x="42"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="85" x="204.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">navigator.mozApps.installPackage(manifestURL, ...)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj88)" stroke-width="2" d="M32,100C32,100,329.5638818740845,100,371.9899822194129,100" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="121" y="115" x="144"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="125" x="204.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">return DOMRequest</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj91)" stroke-width="2" d="M377,140C377,140,79.43611812591553,140,37.01001778058708,140" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="153" y="155" x="397"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="165" x="473.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps:InstallPackage</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj94)" stroke-width="2" d="M377,180C377,180,534.6984945684671,180,564.9984738715393,180" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="63" y="200" x="590"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="53" y="205" x="595"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="215" x="621.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Check ...</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="89" y="250" x="590"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="79" y="255" x="595"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="265" x="634.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Download ...</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="64" y="300" x="590"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="54" y="305" x="595"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="315" x="622" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Install ...</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="169" y="345" x="389"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="355" x="473.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps:Install:Return:OK</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj106)" stroke-width="2" d="M570,370C570,370,412.30150543153286,370,382.0015261284607,370" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="70" y="385" x="169.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="395" x="204.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">fire success</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj109)" stroke-width="2" d="M377,410C377,410,79.43611812591553,410,37.01001778058708,410" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="173" y="425" x="387.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="435" x="473.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps:Install:Return:Ack</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj112)" stroke-width="2" d="M377,450C377,450,534.6984945684671,450,564.9984738715393,450" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="244" y="470" x="595"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="480" x="717" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">updateAppHandlers(null, newManifest)</tspan></text><path stroke-dasharray="0" stroke-width="2" d="M570,465L590,465" stroke="#000000" fill="none" style=""></path><path stroke-dasharray="0" stroke-width="2" d="M590,465L590,500" stroke="#000000" fill="none" style=""></path><path marker-end="url(#raphael-marker-endblock55-obj117)" stroke-dasharray="0" stroke-width="2" d="M590,500C590,500,580.9191131591797,500,574.9952533841133,500" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="57" y="505" x="683.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="515" x="712" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">register()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj120)" stroke-width="2" d="M570,530C570,530,811.0389088988304,530,848.9954753636121,530" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="135" y="550" x="879"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="560" x="946.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">_updateAllWindows()</tspan></text><path stroke-dasharray="0" stroke-width="2" d="M854,545L874,545" stroke="#000000" fill="none" style=""></path><path stroke-dasharray="0" stroke-width="2" d="M874,545L874,580" stroke="#000000" fill="none" style=""></path><path marker-end="url(#raphael-marker-endblock55-obj125)" stroke-dasharray="0" stroke-width="2" d="M874,580C874,580,864.9191131591797,580,858.9952533841133,580" stroke="#000000" fill="none" style=""></path></svg></div>



<h4 id="uninstall">Uninstall</h4>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.5px; top: 0.233276px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1064.5" version="1.1" height="440"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj167"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj170"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj179"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj184"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj187"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="44" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="24" y="30" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="32" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">App</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="44" y="380" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="24" y="390" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="400" x="32" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">App</tspan></text><path stroke-width="2" d="M32,60L32,380" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="91" y="20" x="338.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="71" y="30" x="348.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="384" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="91" y="380" x="338.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="71" y="390" x="348.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="400" x="384" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.js</tspan></text><path stroke-width="2" d="M384,60L384,380" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="20" x="539.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="30" x="549.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="591" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="380" x="539.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="390" x="549.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="400" x="591" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><path stroke-width="2" d="M591,60L591,380" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="20" x="662.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="30" x="672.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="748" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="380" x="662.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="390" x="672.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="400" x="748" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><path stroke-width="2" d="M748,60L748,380" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="332" y="75" x="42"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="85" x="208" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">navigator.mozApps.mgmt.uninstall(DOMApplication)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj167)" stroke-width="2" d="M32,100C32,100,336.08046531677246,100,378.99025754164904,100" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="118" y="115" x="428.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="125" x="487.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps:Uninstall</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj170)" stroke-width="2" d="M384,140C384,140,554.4192790836096,140,585.9984374880187,140" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="63" y="160" x="611"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="53" y="165" x="616"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="175" x="642.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Check ...</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="58" y="210" x="611"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="48" y="215" x="616"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="225" x="640" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Clear ...</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="73" y="255" x="633"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="265" x="669.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">unregister()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj179)" stroke-width="2" d="M591,280C591,280,716.2181141376495,280,742.9981600323226,280" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="161" y="300" x="773"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="310" x="853.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">_unloadForManifestURL()</tspan></text><path stroke-dasharray="0" stroke-width="2" d="M748,295L768,295" stroke="#000000" fill="none" style=""></path><path stroke-dasharray="0" stroke-width="2" d="M768,295L768,330" stroke="#000000" fill="none" style=""></path><path marker-end="url(#raphael-marker-endblock55-obj184)" stroke-dasharray="0" stroke-width="2" d="M768,330C768,330,758.9191131591797,330,752.9952533841133,330" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="187" y="335" x="394"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="345" x="487.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps:Uninstall:Return:OK</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj187)" stroke-width="2" d="M591,360C591,360,420.5807209163904,360,389.0015625119813,360" stroke="#000000" fill="none" style=""></path></svg></div>



<h4 id="update">Update</h4>

<p>Version control?</p>



<h4 id="other">Other</h4>

<dl>
<dt>Hackerplace</dt>
<dd><a href="https://github.com/fxos/directory">https://github.com/fxos/directory</a></dd>

<dd><a href="http://directory.fxosapps.org/apps.json">http://directory.fxosapps.org/apps.json</a></dd>
</dl>

<hr>



<h2 id="add-on-sdk-on-firefox-desktop">Add-on sdk on Firefox Desktop</h2>

<p>TDB</p>



<h4 id="note">Note</h4>

<ul>
<li>Addon manifest: <strong>install.rdf</strong> ?</li>
<li>installRequiresRestart(this.addon) –&gt; addon provides bootstrap or not ?</li>
</ul>

<hr>



<h2 id="chrome-extension-api-on-firefox-desktop">Chrome Extension API on Firefox Desktop</h2>

<dl>
<dt>Introduce Chrome Extension API</dt>
<dd><a href="https://docs.google.com/a/mozilla.com/presentation/d/1LscJGUTO74hP_6tEf6I6_nsAR24xSu9WhHUKk182eaE/edit?usp=sharing">https://docs.google.com/a/mozilla.com/presentation/d/1LscJGUTO74hP_6tEf6I6_nsAR24xSu9WhHUKk182eaE/edit?usp=sharing</a></dd>

<dt>Bugs</dt>
<dd><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1161828">Bug 1161828 - [meta] Parity with Chrome extension API</a> <br>
– <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1175770">Bug 1175770 - Experiment with new extension API</a> <br>
– <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1190692">Bug 1190692 - Support Web Extensions in the add-on manager</a></dd>
</dl>



<h4 id="manifest">Manifest</h4>

<p><a href="https://developer.chrome.com/extensions/manifest">https://developer.chrome.com/extensions/manifest</a></p>



<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-string">"applications"</span>: {
  <span class="hljs-string">"gecko"</span>: {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"{the-addon-id}"</span>, <span class="hljs-comment">// UUID</span>
    <span class="hljs-string">"strict_min_version"</span>: <span class="hljs-string">"40.0.0"</span>,
    <span class="hljs-string">"strict_max_version"</span>: <span class="hljs-string">"50.*"</span>
    <span class="hljs-string">"update_url"</span>: <span class="hljs-string">"https://foo/bar"</span>
  }
}</code></pre>



<h4 id="installation-1">Installation</h4>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.5px; top: -0.0666504px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="1063" version="1.1" height="650"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj250"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj255"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj263"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj266"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj269"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj275"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj281"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj284"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj287"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="116" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="96" y="30" x="20.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="68" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">AddonManager</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="116" y="590" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="96" y="600" x="20.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="68" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">AddonManager</tspan></text><path stroke-width="2" d="M68,60L68,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="119" y="20" x="215.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="99" y="30" x="225.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="275" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">XPIProvider.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="119" y="590" x="215.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="99" y="600" x="225.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="275" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">XPIProvider.jsm</tspan></text><path stroke-width="2" d="M275,60L275,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="184" y="20" x="426"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="164" y="30" x="436"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="518" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">WebExtensionBootstrap.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="184" y="590" x="426"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="164" y="600" x="436"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="518" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">WebExtensionBootstrap.js</tspan></text><path stroke-width="2" d="M518,60L518,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="20" x="630"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="30" x="640"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="683.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="590" x="630"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="600" x="640"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="683.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><path stroke-width="2" d="M683.5,60L683.5,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="189" y="20" x="757"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="169" y="30" x="767"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="851.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ExtensionManagement.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="189" y="590" x="757"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="169" y="600" x="767"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="851.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ExtensionManagement.jsm</tspan></text><path stroke-width="2" d="M851.5,60L851.5,590" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="67" y="20" x="966"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="47" y="30" x="976"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="999.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_*.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="67" y="590" x="966"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="47" y="600" x="976"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="610" x="999.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_*.js</tspan></text><path stroke-width="2" d="M999.5,60L999.5,590" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="187" y="75" x="78"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="85" x="171.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">AddonInstall.initLocalInstall()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj250)" stroke-width="2" d="M68,100C68,100,238.41927908360958,100,269.9984374880187,100" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="203" y="120" x="300"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="130" x="401.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">loadManifestFromWebManifest()</tspan></text><path stroke-dasharray="0" stroke-width="2" d="M275,115L295,115" stroke="#000000" fill="none" style=""></path><path stroke-dasharray="0" stroke-width="2" d="M295,115L295,150" stroke="#000000" fill="none" style=""></path><path marker-end="url(#raphael-marker-endblock55-obj255)" stroke-dasharray="0" stroke-width="2" d="M295,150C295,150,285.9191131591797,150,279.9952533841133,150" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="192" y="160" x="295"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="182" y="165" x="300"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="175" x="391" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">addon.type = "webextension"</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="93" y="210" x="300"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="220" x="346.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">startInstall() ??</tspan></text><path stroke-dasharray="0" stroke-width="2" d="M275,205L295,205" stroke="#000000" fill="none" style=""></path><path stroke-dasharray="0" stroke-width="2" d="M295,205L295,240" stroke="#000000" fill="none" style=""></path><path marker-end="url(#raphael-marker-endblock55-obj263)" stroke-dasharray="0" stroke-width="2" d="M295,240C295,240,285.9191131591797,240,279.9952533841133,240" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="164" y="245" x="314.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="255" x="396.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">load bootstrap (sandbox?)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj266)" stroke-width="2" d="M275,270C275,270,478.3544890284538,270,513.0081592779316,270" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="49" y="285" x="372"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="295" x="396.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">install()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj269)" stroke-width="2" d="M275,310C275,310,478.3544890284538,310,513.0081592779316,310" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="78" y="330" x="538"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="68" y="335" x="543"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="345" x="577" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">do nothing</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="55" y="375" x="369"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="385" x="396.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">startup()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj275)" stroke-width="2" d="M275,400C275,400,478.3544890284538,400,513.0081592779316,400" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="110" y="420" x="538"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="100" y="425" x="543"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="435" x="593" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">new Extension()</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="116" y="465" x="709.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="475" x="767.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">startupExtension()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj281)" stroke-width="2" d="M683.5,490C683.5,490,818.5925011634827,490,846.4949074096512,490" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="55" y="505" x="573.25"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="515" x="600.75" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">startup()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj284)" stroke-width="2" d="M518,530C518,530,650.8648895025253,530,678.5018245259998,530" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="95" y="545" x="794"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="555" x="841.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">emit("startup")</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj287)" stroke-width="2" d="M683.5,570C683.5,570,954.1915853023529,570,994.5045411213068,570" stroke="#000000" fill="none" style=""></path></svg></div>



<h4 id="load">Load</h4>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.5px; top: -0.866699px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="918" version="1.1" height="410"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj331"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj337"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj343"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="30" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="63.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="350" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="360" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="370" x="63.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><path stroke-width="2" d="M63.5,60L63.5,350" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="167" y="20" x="204"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="147" y="30" x="214"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="287.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_backgroundPage.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="167" y="350" x="204"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="147" y="360" x="214"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="370" x="287.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_backgroundPage.js</tspan></text><path stroke-width="2" d="M287.5,60L287.5,350" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="151" y="20" x="488"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="131" y="30" x="498"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="563.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_browserAction.js</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="151" y="350" x="488"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="131" y="360" x="498"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="370" x="563.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ext_browserAction.js</tspan></text><path stroke-width="2" d="M563.5,60L563.5,350" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="157" y="20" x="731"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="137" y="30" x="741"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="809.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ExtensionContent.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="157" y="350" x="731"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="137" y="360" x="741"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="370" x="809.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">ExtensionContent.jsm</tspan></text><path stroke-width="2" d="M809.5,60L809.5,350" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="114" y="80" x="83.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="104" y="85" x="88.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="95" x="140.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">load manifest ....</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="204" y="125" x="73.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="135" x="175.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">emit("manifest_background", ...)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj331)" stroke-width="2" d="M63.5,150C63.5,150,249.45651245117188,150,282.5073769688606,150" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="236" y="170" x="307.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="226" y="175" x="312.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="185" x="425.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">GlobalManager.injectInDocShell() ??</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="227" y="215" x="200"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="225" x="313.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">emit("manifest_browser_action", ...)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj337)" stroke-width="2" d="M63.5,240C63.5,240,506.27817755937576,240,558.4905456651322,240" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="30" width="206" y="260" x="583.5"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="196" y="265" x="588.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="275" x="686.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">CustomizableUI.createWidget()</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="253" y="305" x="310"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="315" x="436.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension:Startup (with content_scripts)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj343)" stroke-width="2" d="M63.5,330C63.5,330,739.5535430684686,330,804.5015580092504,330" stroke="#000000" fill="none" style=""></path></svg></div>



<h4 id="other-1">Other</h4>

<ul>
<li><strong>Extension.jsm</strong> is the main entry point for extensions. When an extension loads, its <strong>bootstrap.js</strong> file creates a Extension instance and calls <code>.startup()</code> on it. It calls <code>.shutdown()</code> when the extension unloads. Extension manages any extension-specific state in the chrome process.</li>
<li>Addon manifest: <strong>install.rdf</strong> and <strong>manifest.json</strong></li>
<li><code>addon._sourceBundle</code></li>
<li><strong>WebExtensionBootstrap.js</strong></li>
<li>Access moz-extension: <code>moz-extension:// + uuid</code>?</li>
<li>Communication between background page and contect script ?</li>
</ul>

<hr>



<h2 id="new-extension-model-in-b2g">New extension model in b2g</h2>

<dl>
<dt>Bugs</dt>
<dd><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1192026">Bug 1192026 - [meta] Add-on support for 2.5</a> <br>
– <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1190995">Bug 1190995 - Support the new extension model in b2g</a> <br>
– <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1191619">Bug 1191619 - Support extensions with no packaged manifest.webapp</a></dd>
</dl>



<h4 id="manifest-1">Manifest</h4>



<h4 id="load-1">Load</h4>



<div class="sequence-diagram"><svg style="overflow: hidden; position: relative; left: -0.5px; top: -0.283447px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="461" version="1.1" height="220"><desc>Created with Raphaël 2.1.2</desc><defs><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj372"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj375"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="20" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="30" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="61.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="103" y="160" x="10"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="83" y="170" x="20"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="180" x="61.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Webapps.jsm</tspan></text><path stroke-width="2" d="M61.5,60L61.5,160" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="20" x="133"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="30" x="143"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="218.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="171" y="160" x="133"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="151" y="170" x="143"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="180" x="218.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">UserCustomizations.jsm</tspan></text><path stroke-width="2" d="M218.5,60L218.5,160" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="20" x="324"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="30" x="334"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="40" x="377.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="40" width="107" y="160" x="324"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="87" y="170" x="334"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="180" x="377.5" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">Extension.jsm</tspan></text><path stroke-width="2" d="M377.5,60L377.5,160" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="57" y="75" x="111.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="85" x="140" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">register()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj372)" stroke-width="2" d="M61.5,100C61.5,100,186.71811413764954,100,213.49816003232263,100" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="20" width="55" y="115" x="270.5"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="125" x="298" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5">startup()</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj375)" stroke-width="2" d="M218.5,140C218.5,140,345.5213388800621,140,372.5009689644503,140" stroke="#000000" fill="none" style=""></path></svg></div>



<h4 id="other-2">Other</h4>



<h4 id="security">Security</h4>

<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Script_security">https://developer.mozilla.org/en-US/docs/Mozilla/Gecko/Script_security</a></li>
<li><a href="https://dxr.mozilla.org/mozilla-central/source/caps/nsIPrincipal.idl">https://dxr.mozilla.org/mozilla-central/source/caps/nsIPrincipal.idl</a></li>
</ul></div></body>
</html>